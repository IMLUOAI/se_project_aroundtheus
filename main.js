!function(){"use strict";class e{constructor(e,t,s,r,i){let{name:o,link:n}=e;this._name=o,this._link=n,this._cardSelector=t,this._handleImageClick=s,this._cardElement=this._getTemplate(),this._handleDeleteConfirmSubmit=r,this._handleCardLike=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeButton),this._deleteButton.addEventListener("click",this._handleDeleteCard),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}_handleLikeButton=()=>{this._likeButton.classList.toggle("card__heart-button_active")};_handleDeleteCard=()=>{this._cardElement.remove(),this._cardElement=null};getView(){return this._likeButton=this._cardElement.querySelector(".card__heart-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=`photo of ${this._name}`,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_setEventListeners=()=>{this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))};_showInputError=e=>{const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)};_hideInputError=e=>{const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""};_checkInputValidity=e=>{if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)};_hasInvalidInput=()=>!this._inputList.every((e=>e.validity.valid));toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}enableValidation=()=>{this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close-button"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal__opened")&&this.close()})),this._closeButton.addEventListener("click",(()=>{this.close()}))}}class r extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputElements=this._popupElement.querySelectorAll(".modal__input")}_getInputValues(){const e=Array.from(this._popupForm.querySelectorAll(".modal__input"));return this._inputValues={},e.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}close(){super.close(),this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const i={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},o=(document.querySelector(".gallery__cards"),document.querySelector("#card-template").content.firstElementChild,document.querySelector("#edit-modal"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector(".profile__edit-button")),n=document.querySelector(".profile__avatar-edit-button"),a=document.forms["profile-form"],l=a.querySelector("#profile-name-input"),d=a.querySelector("#profile-description-input"),c=document.querySelector("#add-card-modal"),u=document.querySelector(".profile__plus-button"),h=document.forms["card-form"],m=(h.querySelector("#card-title-input"),h.querySelector("#card-url-input"),document.querySelector("#preview-image-modal")),_=(m.querySelector(".modal__preview-image"),m.querySelector(".modal__preview-text"),document.querySelector("#profile-modal-closed"),c.querySelector("#add-card-modal-closed"),document.querySelector("#preview-image-closed"),new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._containerSelector=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._containerSelector.prepend(e)}}({items:[{name:"Lonely Earth",link:"https://images.unsplash.com/photo-1507499739999-097706ad8914?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=689&q=80"},{name:"Boys Bathing",link:"https://images.unsplash.com/photo-1688649102473-099b9d16aa32?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=761&q=80"},{name:"Cloudy Sunrise",link:"https://images.unsplash.com/photo-1680100612420-e57b14dd2c7e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=764&q=80"},{name:"Teran",link:"https://images.unsplash.com/photo-1688634219076-aa0815bfa7b4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=699&q=80"},{name:"Flowers",link:"https://images.unsplash.com/photo-1687431343219-2ea06211d6bf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=764&q=80"},{name:"No face to be shown",link:"https://images.unsplash.com/photo-1689008365999-fa5224b16326?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=754&q=80"},{name:"cat",link:"https://images.unsplash.com/photo-1680638867616-374c1b78f2b3?q=80&w=2487&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"}],renderer:e=>{const t=v(e);_.addItem(t)}},".gallery__cards"));_.renderItems();const p=new t(i,document.forms["card-form"]);p.enableValidation();const f=new t(i,documnet.forms["avatar-form"]);f.enableValidation();const E=new t(i,document.forms["profile-form"]);E.enableValidation();const b=new r("#change-profile-avatar-modal",handleChangeProfileAvatarFormSubmit),S=new class extends s{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".modal__preview-image"),this._popupCaption=this._popupElement.querySelector(".modal__preview-text")}open(e,t){this._popupImage.src=t,this._popupImage.alt=e,this._popupCaption.textContent=e,super.open()}}("#preview-image-modal");S.setEventListeners(),new r("#delete-card-modal",handleDeleteCardFormSubmit).setEventListeners();const g=new r("#add-card-modal",(e=>{!function(e){const t=v(e);_.addItem(t)}({name:e.Title,link:e.URL}),g.close()}));g.setEventListeners();const y=new r("#edit-modal",(e=>{x.setUserInfo(e.name,e.description),y.close()}));function v(t){return new e(t,"#card-template",(()=>{S.open(t.name,t.link)})).getView()}y.setEventListeners(),o.addEventListener("click",(()=>{const e=x.getUserInfo();l.value=e.name,d.value=e.job,E.toggleButtonState(),y.open()})),u.addEventListener("click",(()=>{p.toggleButtonState(),g.open()})),n.addEventListener("click",(()=>{f.toggleButtonState(),b.open()})),Promise.all([w.getInitialCards(),w.getProfileApi()]).then((e=>{let[t,s]=e}));const w=new class{constructor(e){this._url=e.url,this._headers=e.headers}_getRes(e){return e.ok?e.json():Promise.reject("Error:${res.status}")}getProfileApi(){return fetch(this.url+"/users/me",{headers:this._headers}).then(this._getRes)}editProfileApi(e){return fetch(this._url+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,job:e.description})}).then(this._getRes)}getInitialCards(){return fetch(this._url+"/cards",{method:"GET",headers:this._headers}).then(this._getRes)}createCardApi(e){return fetch(this._url+"/cards",{method:"POST",headers:this._headers,boyd:JSON.stringify({name:cardData.title,link:cardData.url})}).then(this._getRes)}deleteCard(e){return fetch(this._url+"/cards/${cardID}",{method:"DELETE",headers:this._headers}).then(this._getRes)}updateAvatar(e){return fetch(this._url+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.url})}).then(this._getRes)}getLikes(e){return fetch("${this._url}/cards/likes/${cardID}",{headers:this._headers}).then(this._getRes)}likeCard(e){return fetch(this._url+"/cards/${cardID}/likes",{method:"PUT",headers:this._headeres}).then(this._getRes)}disLikeCard(e){return fetch(this._url+"/cards/${cardID}/likes",{method:"DELETE",headers:this._headers}).then(this._getRes)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"017f0c48-eeeb-4059-9c3c-1a662a9e8f92","Content-Type":"application/json"}}),x=new class{constructor(e,t,s){this._titleElement=document.querySelector(e),this._descriptionElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._titleElement.textContent,job:this._descriptionElement.textContent}}setUserInfo(e,t,s,r){this._titleElement.textContent=e,this._descriptionElement.textContent=t,this._avatarElement.src=s,this._userID=r}getID(){return this._userID}}(".profile__title",".profile__description",".profile__avatar")}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0Isc0JBSWQzQyxFQUFXLElJdEhGLE1BQ2I1SSxXQUFBQSxDQUFZd0wsRUFBZUMsRUFBcUJDLEdBQzlDbEwsS0FBS21MLGNBQWdCMUssU0FBU0MsY0FBY3NLLEdBQzVDaEwsS0FBS29MLG9CQUFzQjNLLFNBQVNDLGNBQWN1SyxHQUNsRGpMLEtBQUtxTCxlQUFpQjVLLFNBQVNDLGNBQWN3SyxFQUMvQyxDQUVBMUMsV0FBQUEsR0FLRSxNQUppQixDQUNmMUksS0FBTUUsS0FBS21MLGNBQWN6SixZQUN6QitHLElBQUt6SSxLQUFLb0wsb0JBQW9CMUosWUFHbEMsQ0FDQTJHLFdBQUFBLENBQVl2SSxFQUFNMkksRUFBS2dDLEVBQVFhLEdBQzdCdEwsS0FBS21MLGNBQWN6SixZQUFjNUIsRUFDakNFLEtBQUtvTCxvQkFBb0IxSixZQUFjK0csRUFDdkN6SSxLQUFLcUwsZUFBZTVKLElBQU1nSixFQUMxQnpLLEtBQUt1TCxRQUFVRCxDQUNqQixDQUNBRSxLQUFBQSxHQUNFLE9BQU94TCxLQUFLdUwsT0FDZCxHSmlHQSxrQkFDQSx3QkFDQSxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy91dGlscy9jb25zdGFudC5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgbmFtZSwgbGluayB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNvbmZpcm1TdWJtaXQsXG4gICAgaGFuZGxlQ2FyZExpa2VcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDb25maXJtU3VibWl0ID0gaGFuZGxlRGVsZXRlQ29uZmlybVN1Ym1pdDtcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKTtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQpO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlQnV0dG9uID0gKCkgPT4ge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2hlYXJ0LWJ1dHRvbl9hY3RpdmVcIik7XG4gIH07XG5cbiAgX2hhbmRsZURlbGV0ZUNhcmQgPSAoKSA9PiB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xuICB9O1xuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faGVhcnQtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSBgcGhvdG8gb2YgJHt0aGlzLl9uYW1lfWA7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihvcHRpb25zLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IG9wdGlvbnMuZm9ybVNlbGVjdG9yO1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBvcHRpb25zLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBvcHRpb25zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBvcHRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb3B0aW9ucy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IG9wdGlvbnMuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChldnQpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfTtcblxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfTtcblxuICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT4ge1xuICAgIHJldHVybiAhdGhpcy5faW5wdXRMaXN0LmV2ZXJ5KFxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXG4gICAgKTtcbiAgfTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uID0gKCkgPT4ge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxuICAgICk7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBfaW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIilcbiAgICApO1xuICAgIHRoaXMuX2lucHV0VmFsdWVzID0ge307XG4gICAgX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0VmFsdWVzO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJMb25lbHkgRWFydGhcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTA3NDk5NzM5OTk5LTA5NzcwNmFkODkxND9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz02ODkmcT04MFwiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkJveXMgQmF0aGluZ1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2ODg2NDkxMDI0NzMtMDk5YjlkMTZhYTMyP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTc2MSZxPTgwXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiQ2xvdWR5IFN1bnJpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjgwMTAwNjEyNDIwLWU1N2IxNGRkMmM3ZT9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03NjQmcT04MFwiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIlRlcmFuXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTY4ODYzNDIxOTA3Ni1hYTA4MTViZmE3YjQ/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njk5JnE9ODBcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJGbG93ZXJzXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTY4NzQzMTM0MzIxOS0yZWEwNjIxMWQ2YmY/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzY0JnE9ODBcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJObyBmYWNlIHRvIGJlIHNob3duXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTY4OTAwODM2NTk5OS1mYTUyMjRiMTYzMjY/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9NzU0JnE9ODBcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJjYXRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjgwNjM4ODY3NjE2LTM3NGMxYjc4ZjJiMz9xPTgwJnc9MjQ4NyZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBvcHRpb25zID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGNhcmRzV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZHNcIik7XG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19hdmF0YXItZWRpdC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1mb3JtXCJdO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLW5hbWUtaW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IHByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcblxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGx1cy1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBjYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1mb3JtXCJdO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRUaXRsZUlucHV0ID0gY2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRpdGxlLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRVcmxJbnB1dCA9IGNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC11cmwtaW5wdXRcIik7XG5cbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2UgPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiXG4pO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUNhcHRpb24gPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fcHJldmlldy10ZXh0XCJcbik7XG5cbi8vICBRdWVyeSBTZWxlY3RvcnMgZm9yIENsb3NlIEJ1dHRvbnNcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtbW9kYWwtY2xvc2VkXCJcbik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjYWRkLWNhcmQtbW9kYWwtY2xvc2VkXCJcbik7XG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcmV2aWV3LWltYWdlLWNsb3NlZFwiXG4pO1xuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHtcbiAgaW5pdGlhbENhcmRzLFxuICBvcHRpb25zLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcbiAgcHJvZmlsZU5hbWVJbnB1dCxcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIHByb2ZpbGVBdmF0YXJFZGl0QnV0dG9uLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnQuanNcIjtcblxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XG4gICAgfSxcbiAgfSxcbiAgXCIuZ2FsbGVyeV9fY2FyZHNcIlxuKTtcbnNlY3Rpb24ucmVuZGVySXRlbXMoKTtcblxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImNhcmQtZm9ybVwiXTtcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Iob3B0aW9ucywgYWRkQ2FyZEZvcm0pO1xuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBjaGFuZ2VQcm9maWxlQXZhdGFyRm9ybSA9IGRvY3VtbmV0LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl07XG5jb25zdCBjaGFuZ2VQcm9maWxlQXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBvcHRpb25zLFxuICBjaGFuZ2VQcm9maWxlQXZhdGFyRm9ybVxuKTtcbmNoYW5nZVByb2ZpbGVBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5jb25zdCBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBlZGl0UHJvZmlsZUZvcm0pO1xuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgY2hhbmdlUHJvZmlsZUF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2NoYW5nZS1wcm9maWxlLWF2YXRhci1tb2RhbFwiLFxuICBoYW5kbGVDaGFuZ2VQcm9maWxlQXZhdGFyRm9ybVN1Ym1pdFxuKTtcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjZGVsZXRlLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlRGVsZXRlQ2FyZEZvcm1TdWJtaXRcbik7XG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwgKHZhbHVlKSA9PiB7XG4gIGNvbnN0IGNhcmREYXRhID0ge1xuICAgIG5hbWU6IHZhbHVlLlRpdGxlLFxuICAgIGxpbms6IHZhbHVlLlVSTCxcbiAgfTtcbiAgcmVuZGVyQ2FyZChjYXJkRGF0YSk7XG4gIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xufSk7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2VkaXQtbW9kYWxcIiwgKHByb2ZpbGVEYXRhKSA9PiB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHByb2ZpbGVEYXRhLm5hbWUsIHByb2ZpbGVEYXRhLmRlc2NyaXB0aW9uKTtcbiAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xufSk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXIgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gdXNlci5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXIuam9iO1xuICBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xufSk7XG5cbnByb2ZpbGVBdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNoYW5nZVByb2ZpbGVBdmF0YXJGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIGNoYW5nZVByb2ZpbGVBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgKCkgPT4ge1xuICAgIGltYWdlUG9wdXAub3BlbihjYXJkRGF0YS5uYW1lLCBjYXJkRGF0YS5saW5rKTtcbiAgfSk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbn1cblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFByb2ZpbGVBcGkoKV0pLnRoZW4oXG4gIChbY2FyZHMsIHVzZXJEYXRhXSkgPT4ge31cbik7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjAxN2YwYzQ4LWVlZWItNDA1OS05YzNjLTFhNjYyYTllOGY5MlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxuICBcIi5wcm9maWxlX190aXRsZVwiLFxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICBcIi5wcm9maWxlX19hdmF0YXJcIlxuKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXJTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG5cbiAgYWRkSXRlbShjYXJkKSB7XG4gICAgdGhpcy5fY29udGFpbmVyU2VsZWN0b3IucHJlcGVuZChjYXJkKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIlxuICAgICk7XG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fcHJldmlldy10ZXh0XCJcbiAgICApO1xuICB9XG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLnVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgX2dldFJlcyhyZXMpIHtcbiAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KFwiRXJyb3I6JHtyZXMuc3RhdHVzfVwiKTtcbiAgfVxuXG4gIGdldFByb2ZpbGVBcGkoKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMudXJsICsgXCIvdXNlcnMvbWVcIiwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2dldFJlcyk7XG4gIH1cblxuICBlZGl0UHJvZmlsZUFwaShkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybCArIFwiL3VzZXJzL21lXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS50aXRsZSxcbiAgICAgICAgam9iOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9nZXRSZXMpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl91cmwgKyBcIi9jYXJkc1wiLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fZ2V0UmVzKTtcbiAgfVxuXG4gIGNyZWF0ZUNhcmRBcGkoQ2FyZERhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fdXJsICsgXCIvY2FyZHNcIiwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib3lkOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGNhcmREYXRhLnRpdGxlLFxuICAgICAgICBsaW5rOiBjYXJkRGF0YS51cmwsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2dldFJlcyk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl91cmwgKyBcIi9jYXJkcy8ke2NhcmRJRH1cIiwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2dldFJlcyk7XG4gIH1cblxuICB1cGRhdGVBdmF0YXIoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl91cmwgKyBcIi91c2Vycy9tZS9hdmF0YXJcIiwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGRhdGEudXJsLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9nZXRSZXMpO1xuICB9XG5cbiAgZ2V0TGlrZXMoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKFwiJHt0aGlzLl91cmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElEfVwiLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fZ2V0UmVzKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLl91cmwgKyBcIi9jYXJkcy8ke2NhcmRJRH0vbGlrZXNcIiwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyZXMsXG4gICAgfSkudGhlbih0aGlzLl9nZXRSZXMpO1xuICB9XG5cbiAgZGlzTGlrZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybCArIFwiL2NhcmRzLyR7Y2FyZElEfS9saWtlc1wiLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fZ2V0UmVzKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih0aXRsZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGl0bGVTZWxlY3Rvcik7XG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB1c2VySW5mbyA9IHtcbiAgICAgIG5hbWU6IHRoaXMuX3RpdGxlRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gICAgcmV0dXJuIHVzZXJJbmZvO1xuICB9XG4gIHNldFVzZXJJbmZvKG5hbWUsIGpvYiwgYXZhdGFyLCBfaWQpIHtcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGpvYjtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcbiAgICB0aGlzLl91c2VySUQgPSBfaWQ7XG4gIH1cbiAgZ2V0SUQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3VzZXJJRDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ29uZmlybVN1Ym1pdCIsImhhbmRsZUNhcmRMaWtlIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9jYXJkRWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9oYW5kbGVEZWxldGVDb25maXJtU3VibWl0IiwiX2hhbmRsZUNhcmRMaWtlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2NhcmRJbWFnZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsImdldFZpZXciLCJfY2FyZFRpdGxlIiwic3JjIiwidGV4dENvbnRlbnQiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwib3B0aW9ucyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsImV2dCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3BvcHVwRm9ybSIsIl9pbnB1dEVsZW1lbnRzIiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJmaXJzdEVsZW1lbnRDaGlsZCIsInByb2ZpbGVBdmF0YXJFZGl0QnV0dG9uIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImFkZENhcmRNb2RhbCIsImFkZE5ld0NhcmRCdXR0b24iLCJjYXJkRm9ybSIsInByZXZpZXdJbWFnZU1vZGFsIiwic2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXJTZWxlY3RvciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsImNhcmQiLCJwcmVwZW5kIiwiY2FyZERhdGEiLCJjcmVhdGVDYXJkIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJjaGFuZ2VQcm9maWxlQXZhdGFyRm9ybVZhbGlkYXRvciIsImRvY3VtbmV0IiwiZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiY2hhbmdlUHJvZmlsZUF2YXRhclBvcHVwIiwiaGFuZGxlQ2hhbmdlUHJvZmlsZUF2YXRhckZvcm1TdWJtaXQiLCJpbWFnZVBvcHVwIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwiaGFuZGxlRGVsZXRlQ2FyZEZvcm1TdWJtaXQiLCJhZGRDYXJkUG9wdXAiLCJyZW5kZXJDYXJkIiwiVGl0bGUiLCJVUkwiLCJlZGl0UHJvZmlsZVBvcHVwIiwicHJvZmlsZURhdGEiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiZGVzY3JpcHRpb24iLCJ1c2VyIiwiZ2V0VXNlckluZm8iLCJqb2IiLCJQcm9taXNlIiwiYWxsIiwiYXBpIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0UHJvZmlsZUFwaSIsInRoZW4iLCJjYXJkcyIsInVzZXJEYXRhIiwiX3VybCIsInVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9nZXRSZXMiLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJmZXRjaCIsImVkaXRQcm9maWxlQXBpIiwiZGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidGl0bGUiLCJjcmVhdGVDYXJkQXBpIiwiQ2FyZERhdGEiLCJib3lkIiwiZGVsZXRlQ2FyZCIsImNhcmRJRCIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImdldExpa2VzIiwibGlrZUNhcmQiLCJfaGVhZGVyZXMiLCJkaXNMaWtlQ2FyZCIsImJhc2VVcmwiLCJhdXRob3JpemF0aW9uIiwidGl0bGVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl90aXRsZUVsZW1lbnQiLCJfZGVzY3JpcHRpb25FbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJfaWQiLCJfdXNlcklEIiwiZ2V0SUQiXSwic291cmNlUm9vdCI6IiJ9